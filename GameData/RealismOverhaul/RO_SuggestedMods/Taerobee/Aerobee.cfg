//  ==================================================
//  Sources:

//  Designation Systems - Aerojet General Aerobee:                    http://www.designation-systems.net/dusrm/n-2.html
//  A COMPENDIUM OF NASA AEROBEE SOUNDING ROCKET LAUNCHINGS FOR 1964: https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19670025553.pdf
//  The Aerobee 100, 150 and 300 Series Sounding Rockets:             http://rasaero.com/dloads/The%20Aerobee%20Sounding%20Rockets.pdf
//  NASA SOUNDING ROCKETS, 1958-1968 - A Historical Summary:          http://www.history.nasa.gov/SP-4401/ch4.htm

//  ==================================================
//  Aerobee payload nose cone.

//  DImensions: 0.38 m x - m
//  Inert Mass: - Kg
//  ==================================================

@PART[taerobee_nosecone]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_bottom01 = 0.0, -0.0766, 0.0, 0.0, -1.0, 0.0, 0

    @attachRules = 1,0,1,1,0

    @title = Aerobee NC-3 Nose Cone
    @manufacturer = Aerojet General
    @description = An aerodynamic nose cone for sounding rockets.

    @mass = 1.0
    @crashTolerance = 16
    %brealingForce = 250
    %brealingTorque = 250
    @maxTemp = 673.15
    %skinMaxTemp = 773.15
    @fuelCrossFeed = False
    @tags ^= :$: aerobee
}

//  ==================================================
//  Aerobee science module container.

//  DImensions: 0.38 m x - m
//  Inert Mass: - Kg
//  ==================================================

@PART[taerobee_science]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.1824, 0.0, 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -0.1824, 0.0, 0.0, -1.0, 0.0, 0

    @title = Aerobee SP-M548-A5 Science Module
    @manufacturer = Aerojet General
    @description = A science payload module for sounding rockets. Includes a barometer and thermometer for measuring the atmospheric properties. Place it above the control module and below the nose cone.

    @mass = 1.0
    @crashTolerance = 6
    %brealingForce = 250
    %brealingTorque = 250
    @maxTemp = 473.15
    %skinMaxTemp = 573.15
    %fuelCrossFeed = False

    @MODULE[ModuleAnimateGeneric]:HAS[#animationName[taerobee_thermometer]]
    {
        @startEventGUIName = Open Thermometer Covers
        @endEventGUIName = Close Thermometer Covers
        @actionGUIName = Toggle Thermometer Covers
    }

    @MODULE[ModuleAnimateGeneric]:HAS[#animationName[taerobee_barometer]]
    {
        startEventGUIName = Open Barometer Covers
        endEventGUIName = Close Barometer Covers
        actionGUIName = Toggle Barometer Covers
    }
}

//  ==================================================
//  Aerobee astrionics/telemetry unit.

//  DImensions: 0.38 m x - m
//  Inert Mass: - Kg
//  ==================================================

@PART[taerobee_control]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.0451, 0.0, 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -0.0765, 0.0, 0.0, -1.0, 0.0, 0

    @title = Aerobee CU-47WS Telemetry Unit
    @manufacturer = Aerojet General
    @description = A sounding rocket avionics unit. Allows staging control and data transmissions but no attitude control. Place it above the despin module and below the science instruments.

    @mass = 1.0
    @crashTolerance = 8
    @maxTemp = 473.15
    %skinMaxTemp = 573.15
    %CrewCapacity = 0

    @MODULE[ModuleCommand]
    {
        @RESOURCE[ElectricCharge]
        {
            @rate = 0.1
        }
    }

    @RESOURCE[ElectricCharge]
    {
        @amount = 180
        @maxAmount = 180
    }
}

//  ==================================================
//  Aerobee astrionics/telemetry unit.

//  Remote Tech compatibility.
//  ==================================================

@PART[taerobee_control]:FOR[RealismOverhaul]:NEEDS[RemoteTech]
{
    !MODULE[ModuleDataTransmitter],*{}

    !MODULE[ModuleRTAntenna*],*{}

    !MODULE[ModuleSPU*],*{}

    @MODULE[ModuleCommand]
    {
        @RESOURCE[ElectricCharge]
        {
            @rate -= 0.01
        }
    }

    MODULE
    {
        name = ModuleSPU
        IsRTCommandStation = False
        RTCommandMinCrew = 0
    }

    MODULE
    {
        name = ModuleRTAntenna
        IsRTActive = True
        Mode0OmniRange = 0
        Mode1OmniRange = 150000
        EnergyCost = 0.01

        TRANSMITTER
        {
            PacketInterval = 1.0
            PacketSize = 0.512
            PacketResourceCost = 0.01
        }
    }
}

//  ==================================================
//  Aerobee despin module package.

//  DImensions: 0.38 m x - m
//  Gross Mass: - Kg
//  ==================================================

@PART[taerobee_despin]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.0608, 0.0, 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -0.0608, 0.0, 0.0, -1.0, 0.0, 0

    @title = Aerobee SMS-RT6 Despin Module
    @manufacturer = Aerojet General
    @description = A despinner module for sounding rockets. Contains a very primitive gyroscopic sensor and 4 Helium thrusters to stabilize the spin in order to activate and run the carried experiments.

    @mass = 1.0
    @crashTolerance = 10
    @breakingForce = 250
    @breakingTorque = 250
    @maxTemp = 473.15
    %skinMaxTemp = 573.15
    @bulkheadProfiles = size0
    @tags ^= :$: aerobee

    @MODULE[ModuleRCS*]
    {
        @thrusterPower = 0.05
        !resourceName = NULL

        PROPELLANT
        {
            name = Helium
            ratio = 1.0
        }

        @atmosphereCurve
        {
            @key,0 = 0 100
            @key,1 = 1 50
        }
    }

    @MODULE[ModuleSAS]
    {
        !RESOURCE,*{}
    }

    !MODULE[ModuleFuelTanks],*{}

    MODULE
    {
        name = ModuleFuelTanks
        type = Fuselage
        volume = 5
        basemass = -1

        TANK
        {
            name = Helium
            amount = 1000
            maxAmount = 1000
        }
    }

    !RESOURCE,*{}
}

//  ==================================================
//  Aerobee recovery parachute pack.

//  DImensions: 0.38 m x - m
//  Inert Mass: - Kg
//  ==================================================

@PART[taerobee_parachute]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.1824, 0.0, 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -0.1824, 0.0, 0.0, -1.0, 0.0, 0

    @title = Aerobee RM-8290 Recovery Parachute Pack
    @manufacturer = Aerojet General

    @mass = 1.0
    !crashTolerance,* = NULL
    %crashTolerance = 12
    @breakingForce = 250
    @breakingTorque = 250
    !maxTemp,* = NULL
    %maxTemp = 473.15
    %skinMaxTemp = 573.15
    !stageOffset,* = NULL
    %stageOffset = -1
    %childStageOffset = 0

    @MODULE[ModuleParachute]
    {
        @stowedDrag = 0
        @semiDeployedDrag = 1
        @fullyDeployedDrag = 500
        @minAirPressureToOpen = 0.035
        @deployAltitude = 750
        @deploymentSpeed = 5
        @semiDeploymentSpeed = 2
    }

    @MODULE[ModuleDragModifier]:HAS[#dragCubeName[SEMIDEPLOYED]]
    {
        @dragModifier = 1
    }

    @MODULE[ModuleDragModifier]:HAS[#dragCubeName[DEPLOYED]]
    {
        @dragModifier = 10
    }

    @MODULE[ModuleDecouple]
    {
        @ejectionForce = 1
    }
}

//  ==================================================
//  Aerobee recovery parachute pack.

//  RealChute compatibility.
//  ==================================================

@PART[taerobee_parachute]:FOR[RealismOverhaul]:NEEDS[RealChute]
{
    !sound_parachute_open
    !sound_parachute_single

    @category = none

    !MODULE[ModuleParachute],*{}

    MODULE
    {
        name = RealChuteModule
        caseMass = 0.08
        timer = 0
        mustGoDown = false
        cutSpeed = 0.5
        spareChutes = 1

        PARACHUTE
        {
            material = Nylon
            preDeployedDiameter = 0.5
            deployedDiameter = 2.5
            minIsPressure = true
            minPressure = 0.007
            deploymentAlt = 750
            cutAlt = -1
            preDeploymentSpeed = 2
            deploymentSpeed = 6
            preDeploymentAnimation = taerobee_parachute_semiDeploy
            deploymentAnimation = taerobee_parachute_fullDeploy
            parachuteName = shute
            capName = Cap
        }
    }
}

//  ==================================================
//  Aerobee sustainer propellant tank.

//  DImensions: 0.38 m x - m
//  Gross Mass: - Kg
//  ==================================================

@PART[taerobee_sustainerTank_3]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 1.751, 0.0, 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -1.751, 0.0, 0.0, -1.0, 0.0, 0
    @node_attach = 0.19, 0.0, 0.0, 1.0, 0.0, 0.0

    @category = FuelTank
    @title = Aerobee FT-LF3 Propellant Tank
    @manufacturer = Aerojet General
    @description = A long propellant tank for sounding rockets. Place it below the recovery parachute module.

    @mass = 1.0
    @crashTolerance = 14
    @maxTemp = 573.15
    %skinMaxTemp = 573.15

    !MODULE[ModuleFuelTanks],*{}

    MODULE
    {
        name = ModuleFuelTanks
        type = Fuselage
        volume = 150
        basemass = -1
    }

    !RESOURCE,*{}
}

//  ==================================================
//  Aerobee sustainer engine.

//  DImensions: - m x - m
//  Inert Mass: 8 Kg
//  ==================================================

@PART[taerobee_aerobee]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.221, 0.0, 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -0.302, 0.0, 0.0, -1.0, 0.0, 0

    @category = Engine

    @mass = 0.008
    @crashTolerance = 10
    %brealingForce = 250
    %brealingTorque = 250
    @maxTemp = 573.15
    %skinMaxTemp = 673.15
    %fuelCrossFeed = True
    %stageOffset = 1
    %childStageOffset = 1

    %engineType = Aerobee
    %engineTypeMult = 1
    %ignoreMass = False
    %massOffset = 0

    @MODULE[ModuleEngines*]
    {
        @name = ModuleEnginesRF
        @minThrust = 7.628
        @maxThrust = 7.628
        @heatProduction = 100
        %EngineType = LiquidFuel
        %ullage = True
        %pressureFed = True
        %ignitions = 1

        @PROPELLANT[LiquidFuel]
        {
            @name = Aniline
            @ratio = 0.3268
        }

        PROPELLANT
        {
            name = Furfuryl
            ratio = 0.0817
            %DrawGauge = False
        }

        @PROPELLANT[Oxidizer]
        {
            @name = IRFNA-III
            @ratio = 0.5915
            %DrawGauge = False
        }

        @atmosphereCurve
        {
            @key,0 = 0 218
            @key,1 = 1 191
        }
    }
}

//  ==================================================
//  Aerobee sustainer aerodynamic fin.

//  Dimensions: - m x - m
//  Inert Mass: - Kg
//  ==================================================

@PART[taerobee_smallFin]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.0, 1.0, 1.0
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_attach = 0.0, 0.0, 0.0, 1.0, 0.0, 0.0

    @title = Aerobee W4C-S Aerodynamic Fin
    @manufacturer = Aerojet General
    @description = Small fins for the sustainer stages of sounding rockets. Angle them for spin stabilization.

    @mass = 1.0
    @crashTolerance = 16
    @maxTemp = 673.15
    %skinMaxTemp = 773.15
    @fuelCrossFeed = False
    @tags ^= :$: aerobee

    @MODULE[ModuleLiftingSurface]
    {
        @deflectionLiftCoeff = 0.12 //0.42m^2
    }
}

//  ==================================================
//  Aerobee Aerojet X103C10 SRM decoupler.

//  Dimensions: - m x - m
//  Inert Mass: - Kg
//  ==================================================

@PART[taerobee_decoupler]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.216, 1.216, 1.216
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.1, 0.0 , 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -0.087, 0.0, 0.0, -1.0, 0.0, 0

    @attachRules = 1,0,1,0,0

    @title = Aerobee SD-36 Stack Decoupler
    @manufacturer = Aerojet General
    @description = The decoupling system for the Aerojet X103C10 solid rocket booster motor.

    @mass = 1.0
    @crashTolerance = 14
    @breakingForce = 250
    @breakingTorque = 250
    @maxTemp = 773.15
    %skinMaxTemp = 873.15
    @bulkheadProfiles = size0
    @tags = aerobee booster decoupler solid stage

    @MODULE[ModuleDecouple]
    {
        @ejectionForce = 0
    }
}

//  ==================================================
//  Aerobee Aerojet X103C10 solid rocket motor.

//  Dimensions: - m x - m
//  Gross Mass: - Kg
//  ==================================================

@PART[taerobee_TinyTim]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.0, 1.0, 1.0
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_stack_top = 0.0, 0.572, 0.0, 0.0, 1.0, 0.0, 0
    @node_stack_bottom = 0.0, -0.565, 0.0, 0.0, -1.0, 0.0, 0
    @node_attach = 0.15625, 0.0, 0.0, 1.0, 0.0, 0.0

    @category = Engine
    @title = Aerojet X103C10 (2.5KS18000) rocket motor
    @manufacturer = Aerojet General
    @description = A solid rocket booster motor for sounding rockets.

    @mass = 0.268
    @crashTolerance = 10
    @maxTemp = 573.15
    %skinMaxTemp = 673.15
    %fuelCrossFeed = False
    %stageOffset = 1
    %childStageOffset = 1

    @MODULE[ModuleEngines]
    {
        @name = ModuleEnginesRF
        @minThrust = 0
        @maxThrust = 220
        @heatProduction = 100
        %useEngineResponseTime = True
        %engineAccelerationSpeed = 8.0
        %EngineType = SolidBooster
        %ullage = False
        %pressureFed = False
        %ignitions = 1

        @PROPELLANT[SolidFuel]
        {
            @name = PSPC
        }

        @atmosphereCurve
        {
            @key,0 = 0 220
            @key,1 = 1 200
        }
    }

    !MODULE[ModuleFuelTanks],*{}

    MODULE
    {
        name = ModuleFuelTanks
        type = PSPC
        volume = 37.87
        basemass = -1

        TANK
        {
            name = PSPC
            amount = 37.87
            maxAmount = 37.87
        }
    }

    !RESOURCE,*{}
}

//  ==================================================
//  Aerobee booster aerodynamic fin.

//  Dimensions: - m x - m
//  Inert Mass: 3 Kg
//  ==================================================

@PART[taerobee_largeFin]:FOR[RealismOverhaul]
{
    %RSSROConfig = True

    @MODEL
    {
        %scale = 1.0, 1.0, 1.0
    }

    %scale = 1.0
    @rescaleFactor = 1.0

    @node_attach = 0.0, 0.0, 0.0, 1.0, 0.0, 0.0

    @title = Aerobee W4C-L Aerodynamic Fin
    @manufacturer = Aerojet General
    @description = Large fins for the booster stages of sounding rockets. Angle them for spin stabilization.

    @mass = 0.003
    @crashTolerance = 16
    @maxTemp = 673.15
    %skinMaxTemp = 773.15
    @fuelCrossFeed = False
    @tags ^= :$: aerobee

    @MODULE[ModuleLiftingSurface]
    {
        @deflectionLiftCoeff = 0.12 //0.42m^2
    }
}
